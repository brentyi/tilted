<!doctype html>
<html>
  <head>
    <!-- Google tag (gtag.js) -->
    <meta charset="utf-8" />
    <title>Canonical Factors for Hybrid Neural Fields</title>

    <meta content="" name="description" />
    <meta
      content="Canonical Factors for Hybrid Neural Fields"
      property="og:title"
    />
    <meta
      content="Factored feature volumes have an axis-alignment bias. This can be addressed via a learned set of transforms!"
      property="og:description"
    />
    <meta
      content="https://brentyi.github.io/assets/method_preview.png"
      property="og:image"
    />
    <meta
      content="Canonical Factors for Hybrid Neural Fields"
      property="twitter:title"
    />
    <meta
      content="Factored feature volumes have an axis-alignment bias. This can be addressed via a learned set of transforms!"
      property="twitter:description"
    />
    <meta
      content="https://brentyi.github.io/assets/method_preview.png"
      property="twitter:image"
    />
    <meta property="og:type" content="website" />
    <meta content="summary_large_image" name="twitter:card" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1"
    />

    <link href="assets/favicon.svg" rel="shortcut icon" type="image/x-icon" />

    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link
      href="https://fonts.gstatic.com"
      rel="preconnect"
      crossorigin="anonymous"
    />
    <script
      src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript">
      WebFont.load({
        google: {
          families: [
            "Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic",
          ],
        },
      });
    </script>
    <!--[if lt IE 9
      ]><script
        src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"
        type="text/javascript"
      ></script
    ><![endif]-->

    <script
      src="https://code.jquery.com/jquery-3.7.0.slim.min.js"
      integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE="
      crossorigin="anonymous"
    ></script>

    <!-- Image compare utility. -->
    <link href="./image-compare.css" rel="stylesheet" type="text/css" />
    <script src="./image-compare.js" type="text/javascript"></script>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css"
    />
    <link href="style.css" rel="stylesheet" type="text/css" />

    <!-- KaTeX -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"
      integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn"
      crossorigin="anonymous"
    />
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"
      integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx"
      crossorigin="anonymous"
    ></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"
      integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
      crossorigin="anonymous"
    ></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
            { left: "$$", right: "$$", display: true },
            { left: "$", right: "$", display: false },
            { left: "\\(", right: "\\)", display: false },
            { left: "\\[", right: "\\]", display: true },
          ],
          // • rendering keys, e.g.:
          throwOnError: false,
        });
      });
    </script>
  </head>

  <body>
    <h1 style="font-family: Lato; margin: 0.25em 0">
      Canonical Factors for Hybrid Neural Fields
    </h1>

    <div style="text-align: center; font-weight: 600">@ ICCV 2023</div>
    <div style="height: 1em"></div>

    <!-- Authors -->
    <div
      style="
        display: flex;
        flex-wrap: wrap;
        text-align: center;
        justify-content: center;
        gap: 0.4em 1.25em;
        max-width: 30em;
        margin: 0 auto;
        font-weight: 600;
        color: #666;
      "
    >
      <!-- We group authors based on how we want them to wrap. Sam and Yi are
        grouped together, etc. -->
      <div>
        <a target="_blank">Brent Yi<sup>1</sup></a>
        <div style="width: 1.25em; display: inline-block"></div>
        <a target="_blank">Weijia Zeng<sup>1</sup></a>
      </div>
      <div>
        <a href="https://sdbuchanan.com/" target="_blank">Sam Buchanan</a
        ><sup>2</sup>
        <div style="width: 1.25em; display: inline-block"></div>
        <a href="https://people.eecs.berkeley.edu/~yima/" target="_blank"
          >Yi Ma</a
        ><sup>1</sup>
      </div>
    </div>
    <div style="height: 1em"></div>

    <!-- Affiliations -->
    <div
      style="
        display: flex;
        justify-content: center;
        gap: 2em;
        max-width: 15em;
        margin: 0 auto;
        font-weight: 400;
      "
    >
      <div><sup>1</sup>UC Berkeley</div>
      <div><sup>2</sup>TTIC</div>
    </div>
    <div style="height: 1em"></div>

    <!-- Links -->
    <div
      style="
        display: flex;
        justify-content: center;
        gap: 0.5em 1em;
        flex-wrap: wrap;
      "
    >
      <a href="https://github.com/brentyi/tilted" target="_blank">
        <button>
          <i class="ti ti-brand-github"></i>
          GitHub
        </button>
      </a>
      <a href="https://arxiv.org/abs/2308.15461" target="_blank">
        <button>
          <i class="ti ti-article"></i>
          arXiv
        </button>
      </a>
      <script type="text/javascript">
        function toggleBibtex() {
          const $bibtex = $("#bibtex");
          $bibtex.css(
            "display",
            $bibtex.css("display") === "none" ? "block" : "none",
          );
        }
      </script>
      <a onclick="toggleBibtex()">
        <button>
          <i class="ti ti-book-2"></i>
          BibTeX
        </button>
      </a>
    </div>

    <section id="bibtex" style="display: none">
      <div style="height: 1em"></div>
      <div style="height: 1em"></div>
      <p>
        <code
          style="
            font-family:
              Courier New,
              Courier,
              monospace;
            white-space: nowrap;
            width: 100%;
            max-width: 100%;
            overflow: scroll;
            display: block;
            background-color: #f7f7f7;
            padding: 1em;
            box-sizing: border-box;
            border-radius: 0.5em;
          "
        >
          @inproceedings{tilted2023,<br />
          &nbsp;&nbsp;&nbsp;&nbsp;author = {Yi, Brent and Zeng, Weijia and
          Buchanan, Sam and Ma, Yi},<br />
          &nbsp;&nbsp;&nbsp;&nbsp;title = {Canonical Factors for Hybrid Neural
          Fields},<br />
          &nbsp;&nbsp;&nbsp;&nbsp;booktitle = {International Conference on
          Computer Vision (ICCV)},<br />
          &nbsp;&nbsp;&nbsp;&nbsp;year = {2023},<br />
          }
        </code>
      </p>
    </section>

    <!-- tldr -->
    <p style="text-align: center">
      <strong>TLDR</strong>
      <em>
        Factored feature volumes have an axis-alignment bias.<br />
        This can be addressed via a learned set of transforms!
      </em>
    </p>
    <div style="height: 1em"></div>

    <!-- Big figure -->
    <img src="./assets/TILTED_method.svg" id="tilted-method" />
    <img src="./assets/TILTED_method_narrow.svg" id="tilted-method-narrow" />
    <img
      src="./assets/TILTED_method_very_narrow.svg"
      id="tilted-method-very-narrow"
    />
    <div style="height: 1em"></div>

    <section>
      <h2>Overview</h2>
      <p>
        We study state-of-the-art neural field architectures that rely on
        factored feature volumes, by (1) analyzing factored grids in 2D to
        characterize undesirable biases for axis-aligned signals, and (2) using
        the resulting insights to propose <em>TILTED</em>, a family of hybrid
        neural field architectures that removes these biases.
      </p>
    </section>

    <section>
      <h2>Qualitative Results</h2>
      <p>
        We explore how recovering <em>canonical factors</em> via a learned set
        of transformations can improve factorization-based representations with
        only a handful of extra parameters.
      </p>
      <p>For signed distance fields, this reduces floating artifacts:</p>

      <div
        class="image-compare"
        data-before-label="Vector-Matrix"
        data-after-label="Vector-Matrix + TILTED"
      >
        <img src="./assets/sdf_tilted.png" />
        <img src="./assets/sdf_aligned.png" />
      </div>
      <div style="height: 1em"></div>

      <p>For radiance fields, it improves visual fidelity:</p>
      <div class="switcher">
        <div
          data-switcher-label="Kitchen"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_kitchen_rgb.jpg" />
          <img src="./assets/aligned_kitchen_rgb.jpg" />
        </div>
        <div
          data-switcher-label="Giannini Hall"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_giannini_rgb.jpg" />
          <img src="./assets/aligned_giannini_rgb.jpg" />
        </div>
        <div
          data-switcher-label="Stump"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_stump_rgb.jpg" />
          <img src="./assets/aligned_stump_rgb.jpg" />
        </div>
        <div
          data-switcher-label="Storefront"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_storefront_rgb.jpg" />
          <img src="./assets/aligned_storefront_rgb.jpg" />
        </div>
      </div>

      <p>
        From the norms of interpolated features, we observe that canonicalized
        factors interpretably align themself to scene geometry:
      </p>

      <div class="switcher">
        <div
          data-switcher-label="Kitchen"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_kitchen_norm.jpg" />
          <img src="./assets/aligned_kitchen_norm.jpg" />
        </div>
        <div
          data-switcher-label="Giannini Hall"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_giannini_norm.jpg" />
          <img src="./assets/aligned_giannini_norm.jpg" />
        </div>
        <div
          data-switcher-label="Stump"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_stump_norm.jpg" />
          <img src="./assets/aligned_stump_norm.jpg" />
        </div>
        <div
          data-switcher-label="Storefront"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_storefront_norm.jpg" />
          <img src="./assets/aligned_storefront_norm.jpg" />
        </div>
      </div>

      <p>
        From mapping latent feature vectors to RGB via a principal component
        analysis, we observe a more expressive and interpretable feature volume:
      </p>
      <div class="switcher">
        <div
          data-switcher-label="Kitchen"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_kitchen_pca.jpg" />
          <img src="./assets/aligned_kitchen_pca.jpg" />
        </div>
        <div
          data-switcher-label="Giannini Hall"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_giannini_pca.jpg" />
          <img src="./assets/aligned_giannini_pca.jpg" />
        </div>
        <div
          data-switcher-label="Stump"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_stump_pca.jpg" />
          <img src="./assets/aligned_stump_pca.jpg" />
        </div>
        <div
          data-switcher-label="Storefront"
          class="image-compare"
          data-before-label="K-Planes"
          data-after-label="K-Planes + TILTED"
        >
          <img src="./assets/tilted_storefront_pca.jpg" />
          <img src="./assets/aligned_storefront_pca.jpg" />
        </div>
      </div>
    </section>

    <section>
      <h2>Motivation</h2>
      <p>
        Factored feature volumes offer advantages in compactness, efficiency,
        and interpretability, but biases are introduced by an implicit frame of
        representation.
      </p>

      <p>
        The drawbacks of this are already apparent in 2D. A 2D factored grid is
        simply a low-rank matrix decomposition, whose compactness can be
        undermined by a simple rotation!
      </p>

      <div style="height: 1em"></div>
      <div class="square-container">
        <div>
          <!-- CSS square -->
          <div
            style="
              border: 1px solid black;
              display: inline-block;
              width: 10em;
              height: 10em;
              min-width: 10em;
              position: relative;
            "
          >
            <div
              style="
                background-color: #000;
                width: 5em;
                height: 5em;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translateX(-50%) translateY(-50%);
              "
            ></div>
          </div>
          <!-- prettier-ignore -->
          $
          \ \ \approx
          \newcommand{\w}{\color{lightgray}0}
          \newcommand{\b}{1}
          \Large

          \hspace{0.05em}
          \begin{bmatrix}
            \w & \w & \w & \w & \w \\
            \w & \b & \b & \b & \w \\
            \w & \b & \b & \b & \w \\
            \w & \b & \b & \b & \w \\
            \w & \w & \w & \w & \w \\
          \end{bmatrix}
          \hspace{0.05em}

          \normalsize
          \approx

          \footnotesize

          \begin{bmatrix}
            \w & \w & \w & \w & \w & \w & \w & \w & \w \\
            \w & \w & \w & \w & \w & \w & \w & \w & \w \\
            \w & \w & \b & \b & \b & \b & \b & \w & \w \\
            \w & \w & \b & \b & \b & \b & \b & \w & \w \\
            \w & \w & \b & \b & \b & \b & \b & \w & \w \\
            \w & \w & \b & \b & \b & \b & \b & \w & \w \\
            \w & \w & \b & \b & \b & \b & \b & \w & \w \\
            \w & \w & \w & \w & \w & \w & \w & \w & \w \\
            \w & \w & \w & \w & \w & \w & \w & \w & \w \\
          \end{bmatrix}
          $
        </div>
        <div style="color: #38761d">
          ✔ <em>rank 1 can capture infinite detail</em>
        </div>
      </div>
      <div style="height: 1em"></div>
      <div class="square-container">
        <div>
          <!-- CSS diamond -->
          <div
            style="
              border: 1px solid black;
              display: inline-block;
              width: 10em;
              height: 10em;
              min-width: 10em;
              position: relative;
            "
          >
            <div
              style="
                background-color: #000;
                width: 5em;
                height: 5em;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translateX(-50%) translateY(-50%) rotate(45deg);
              "
            ></div>
          </div>
          <!-- prettier-ignore -->
          $
            \ \ \approx
            \newcommand{\w}{\color{lightgray}0}
            \newcommand{\b}{1}

            \begin{bmatrix}
              \w & \w & \w & \w & \w & \w & \w \\
              \w & \w & \w & \b & \w & \w & \w \\
              \w & \w & \b & \b & \b & \w & \w \\
              \w & \b & \b & \b & \b & \b & \w \\
              \w & \w & \b & \b & \b & \w & \w \\
              \w & \w & \w & \b & \w & \w & \w \\
              \w & \w & \w & \w & \w & \w & \w \\
            \end{bmatrix}

            \normalsize
            \approx

            \footnotesize
            \begin{bmatrix}
              \w & \w & \w & \w & \w & \w & \w & \w & \w \\
              \w & \w & \w & \w & \b & \w & \w & \w & \w \\
              \w & \w & \w & \b & \b & \b & \w & \w & \w \\
              \w & \w & \b & \b & \b & \b & \b & \w & \w \\
              \w & \b & \b & \b & \b & \b & \b & \b & \w \\
              \w & \w & \b & \b & \b & \b & \b & \w & \w \\
              \w & \w & \w & \b & \b & \b & \w & \w & \w \\
              \w & \w & \w & \w & \b & \w & \w & \w & \w \\
              \w & \w & \w & \w & \w & \w & \w & \w & \w \\
            \end{bmatrix}
        $
        </div>
        <div style="color: #990000">
          ✘
          <em>
            rank grows with desired detail, despite equivalent information
          </em>
        </div>
      </div>

      <!--
      <p>
        On the other hand, as soon as the square is rotated (say, by 45
        degrees), its rank becomes proportional to the number of pixels in the
        image <code>&#8212;</code> it cannot be represented compactly without
        sacrificing quality.
      </p>
      -->
      <div style="height: 1em"></div>

      <p>
        TILTED overcomes this limitation of low-rank grids by jointly optimizing
        for <em>canonical factors</em> of the scene appearance and domain
        transformations that capture viewpoint and pose.
      </p>
    </section>

    <section>
      <h2>Theoretical Grounding</h2>

      <p>
        Transformation optimization with a fixed representation (&agrave; la
        image registration) is a challenging problem that is prone to local
        minima; simultaneously learning the representation introduces further
        headaches. We develop the theoretical foundations for this methodology
        <b>
          by proving that optimization recovers the scene appearance and
          transformation parameters
        </b>
        in the 2D square example above. Concretely, we study an
        infinite-dimensional version of the optimization problem
      </p>

      $$ \min_{\boldsymbol{U} \in \mathbb{R}^{n \times k},\, \phi \in [0,
      2\pi]}\, \frac{1}{2} \left\| \boldsymbol{X}_{\diamond} - (\boldsymbol{U}
      \boldsymbol{U}^*) \circ \boldsymbol{\tau}_{\phi} \right\|_2^2,$$

      <p>
        and establish that an alternating minimization approach converges
        linearly to the square's true apperance and pose parameters, despite
        significant nonconvexity in the objective landscape.
      </p>

      <div style="text-align: center">
        <div
          style="
            display: block;
            padding: 2em;
            border-radius: 0.5em;
            background: #000;
          "
        >
          <img src="./assets/diamond_slow.gif" />
          <img src="./assets/diamond_16_slow.gif" />
        </div>
      </div>

      <p>
        With an MLP decoder and regularization, our experiments extend this
        paradigm to more complex signals:
      </p>

      <div style="text-align: center">
        <div
          style="
            display: block;
            padding: 1em;
            border-radius: 0.5em;
            background: #000;
          "
        >
          <img
            src="./assets/fox_alignment_smaller.gif"
            style="width: 20em; max-width: 100%"
          />
        </div>
      </div>

      <p>
        Our analyses uncover a simple conceptual principle underlying the
        success of our method in idealized conditions:
        <b
          >incremental improvements to representation promote incremental
          improvements to alignment, and vice versa,</b
        >
        due to the constrained capacity of factored feature volumes. These
        capacity constraints obtain even when the rank of the grid is large, as
        a consequence of
        <em>implicit regularization in matrix factorization problems</em>
        towards low-rank solutions.
      </p>
    </section>

    <h2>Acknowledgements</h2>
    <section>
      <p>
        This material is based upon work supported by the National Science
        Foundation Graduate Research Fellowship Program under Grant DGE 2146752,
        the ONR grant N00014-22-1-2102, and the joint Simons Foundation-NSF DMS
        grant 2031899.
      </p>
    </section>
  </body>
</html>
